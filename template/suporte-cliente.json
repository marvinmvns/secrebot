{
  "id": "suporte-cliente-template",
  "name": "Suporte ao Cliente",
  "description": "Template para atendimento e suporte ao cliente com escala√ß√£o autom√°tica",
  "alias": "suporte",
  "version": "1.0.0",
  "metadata": {
    "category": "suporte",
    "isTemplate": true,
    "tags": ["atendimento", "suporte", "cliente", "escalacao"],
    "author": "SecreBot Templates",
    "businessType": "any"
  },
  "nodes": [
    {
      "id": "start-1",
      "type": "start",
      "position": { "x": 100, "y": 100 },
      "data": {
        "label": "In√≠cio do Atendimento",
        "message": "Atendimento iniciado"
      }
    },
    {
      "id": "welcome-message",
      "type": "message", 
      "position": { "x": 300, "y": 100 },
      "data": {
        "label": "Boas-vindas",
        "message": "ü§ñ *Ol√°! Bem-vindo ao nosso suporte!*\n\nSou seu assistente virtual e estou aqui para ajudar.\n\n*Como posso ajud√°-lo hoje?*\n\n1Ô∏è‚É£ Problemas t√©cnicos\n2Ô∏è‚É£ D√∫vidas sobre produtos/servi√ßos\n3Ô∏è‚É£ Falar com atendente humano\n4Ô∏è‚É£ Informa√ß√µes de conta\n\nDigite o n√∫mero da op√ß√£o ou descreva seu problema.",
        "isMainMenu": true
      }
    },
    {
      "id": "classify_issue",
      "type": "llm",
      "position": { "x": 500, "y": 100 },
      "data": {
        "label": "Classificar Problema",
        "prompt": "Analise a mensagem do cliente e classifique o tipo de problema/solicita√ß√£o:\n\nCategorias poss√≠veis:\n- technical: Problemas t√©cnicos (erro, bug, n√£o funciona)\n- product: D√∫vidas sobre produtos/servi√ßos (caracter√≠sticas, pre√ßos, disponibilidade)\n- account: Quest√µes de conta (login, dados, faturamento)\n- human: Solicita√ß√£o expl√≠cita para falar com humano\n- complaint: Reclama√ß√£o ou insatisfa√ß√£o\n- other: Outros assuntos\n\nMensagem do cliente: {{user_message}}\n\nResponda APENAS com a categoria (technical, product, account, human, complaint, other).",
        "timeout": 15000,
        "useBalancer": true
      }
    },
    {
      "id": "route_by_category",
      "type": "condition",
      "position": { "x": 700, "y": 100 },
      "data": {
        "label": "Rotear por Categoria",
        "condition": "llm_output === 'human' || llm_output === 'complaint'",
        "description": "Verificar se precisa de atendimento humano"
      }
    },
    {
      "id": "technical_support",
      "type": "llm",
      "position": { "x": 500, "y": 300 },
      "data": {
        "label": "Suporte T√©cnico",
        "prompt": "Voc√™ √© um especialista em suporte t√©cnico. O cliente relatou um problema t√©cnico:\n\n{{user_message}}\n\nForne√ßa uma solu√ß√£o clara e passo-a-passo. Se for um problema complexo, sugira contato com suporte especializado.\n\nSempre:\n- Seja claro e did√°tico\n- Use numera√ß√£o para passos\n- Ofere√ßa alternativas quando poss√≠vel\n- Pergunte se precisa de mais ajuda\n\nSe n√£o conseguir resolver, diga que ir√° conectar com um especialista.",
        "timeout": 20000,
        "useBalancer": true
      }
    },
    {
      "id": "product_info",
      "type": "llm",
      "position": { "x": 700, "y": 300 },
      "data": {
        "label": "Informa√ß√µes de Produto",
        "prompt": "Voc√™ √© um consultor de produtos especializado. O cliente tem d√∫vidas sobre:\n\n{{user_message}}\n\nForne√ßa informa√ß√µes completas e √∫teis sobre:\n- Caracter√≠sticas do produto/servi√ßo\n- Pre√ßos quando relevante\n- Disponibilidade\n- Como adquirir/contratar\n- Benef√≠cios principais\n\nSeja comercial mas n√£o insistente. Ofere√ßa ajuda adicional.",
        "timeout": 20000,
        "useBalancer": true
      }
    },
    {
      "id": "escalate_to_human",
      "type": "message",
      "position": { "x": 900, "y": 100 },
      "data": {
        "label": "Escalar para Humano",
        "message": "üôã‚Äç‚ôÇÔ∏è *Conectando voc√™ com um atendente humano...*\n\nUm de nossos especialistas ir√° atend√™-lo em breve.\n\n‚è±Ô∏è *Tempo m√©dio de espera: 3-5 minutos*\n\nEnquanto aguarda, voc√™ pode:\n- Preparar detalhes do seu problema\n- Ter em m√£os documentos relevantes\n- Anotar perguntas espec√≠ficas\n\n*Aguarde, por favor...*"
      }
    },
    {
      "id": "webhook_create_ticket",
      "type": "webhook",
      "position": { "x": 1100, "y": 100 },
      "data": {
        "label": "Criar Ticket",
        "url": "{{SUPPORT_WEBHOOK_URL}}/create-ticket",
        "method": "POST",
        "payload": {
          "customer_id": "{{user_id}}",
          "category": "{{issue_category}}",
          "description": "{{user_message}}",
          "priority": "normal",
          "source": "whatsapp_bot"
        }
      }
    },
    {
      "id": "satisfaction_survey",
      "type": "message",
      "position": { "x": 500, "y": 500 },
      "data": {
        "label": "Pesquisa de Satisfa√ß√£o",
        "message": "‚≠ê *Como foi nosso atendimento?*\n\nSua opini√£o √© muito importante!\n\nüòÉ Excelente\nüôÇ Bom  \nüòê Regular\nüòû Ruim\n\nDigite sua avalia√ß√£o ou use os emojis."
      }
    },
    {
      "id": "collect_feedback",
      "type": "variable",
      "position": { "x": 700, "y": 500 },
      "data": {
        "label": "Coletar Feedback",
        "variableName": "feedback_rating",
        "value": "{{user_message}}"
      }
    },
    {
      "id": "webhook_save_feedback",
      "type": "webhook",
      "position": { "x": 900, "y": 500 },
      "data": {
        "label": "Salvar Feedback",
        "url": "{{SUPPORT_WEBHOOK_URL}}/feedback",
        "method": "POST",
        "payload": {
          "customer_id": "{{user_id}}",
          "rating": "{{feedback_rating}}",
          "conversation_id": "{{session_id}}",
          "timestamp": "{{current_time}}"
        }
      }
    },
    {
      "id": "final_message",
      "type": "message",
      "position": { "x": 1100, "y": 500 },
      "data": {
        "label": "Mensagem Final",
        "message": "‚úÖ *Obrigado pelo seu contato!*\n\nFoi um prazer ajud√°-lo. Se precisar de mais alguma coisa, estarei sempre aqui.\n\nüîÑ Para voltar ao menu principal: digite *menu*\nüõë Para encerrar: digite *!flow stop*\n\nTenha um √≥timo dia! üòä"
      }
    },
    {
      "id": "error_handler",
      "type": "message",
      "position": { "x": 300, "y": 700 },
      "data": {
        "label": "Tratamento de Erro",
        "message": "üöß *Ops! Tivemos um problema t√©cnico.*\n\nN√£o se preocupe, isso pode acontecer. Vamos tentar de novo:\n\nüîÑ Digite *menu* para voltar ao in√≠cio\nüôã‚Äç‚ôÇÔ∏è Digite *humano* para falar com atendente\nüõë Digite *!flow stop* para encerrar\n\nPedimos desculpas pelo inconveniente."
      }
    }
  ],
  "edges": [
    { "id": "e1", "source": "start-1", "target": "welcome-message" },
    { "id": "e2", "source": "welcome-message", "target": "classify_issue" },
    { "id": "e3", "source": "classify_issue", "target": "route_by_category" },
    { "id": "e4", "source": "route_by_category", "target": "escalate_to_human", "label": "true" },
    { "id": "e5", "source": "route_by_category", "target": "technical_support", "label": "false" },
    { "id": "e6", "source": "escalate_to_human", "target": "webhook_create_ticket" },
    { "id": "e7", "source": "webhook_create_ticket", "target": "final_message" },
    { "id": "e8", "source": "technical_support", "target": "satisfaction_survey" },
    { "id": "e9", "source": "product_info", "target": "satisfaction_survey" },
    { "id": "e10", "source": "satisfaction_survey", "target": "collect_feedback" },
    { "id": "e11", "source": "collect_feedback", "target": "webhook_save_feedback" },
    { "id": "e12", "source": "webhook_save_feedback", "target": "final_message" }
  ],
  "configuration": {
    "webhooks": {
      "support_system": {
        "base_url": "https://api.yoursupport.com",
        "auth_header": "Authorization: Bearer {{SUPPORT_API_KEY}}",
        "timeout": 10000
      }
    },
    "variables": {
      "SUPPORT_WEBHOOK_URL": "https://api.yoursupport.com/v1",
      "SUPPORT_API_KEY": "your-api-key-here"
    },
    "settings": {
      "auto_escalation_timeout": 300,
      "max_llm_attempts": 2,
      "enable_satisfaction_survey": true
    }
  }
}