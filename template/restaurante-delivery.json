{
  "id": "restaurante-delivery-template",
  "name": "Restaurante e Delivery",
  "description": "Template para pedidos de delivery com cardÃ¡pio interativo e acompanhamento de entrega",
  "alias": "delivery",
  "version": "1.0.0",
  "metadata": {
    "category": "alimentacao",
    "isTemplate": true,
    "tags": ["restaurante", "delivery", "cardapio", "pedido", "food"],
    "author": "SecreBot Templates",
    "businessType": "restaurant"
  },
  "nodes": [
    {
      "id": "start-1",
      "type": "start",
      "position": { "x": 100, "y": 100 },
      "data": {
        "label": "InÃ­cio Pedido",
        "message": "Sistema de delivery iniciado"
      }
    },
    {
      "id": "restaurant_welcome",
      "type": "message",
      "position": { "x": 300, "y": 100 },
      "data": {
        "label": "Boas-vindas Restaurante",
        "message": "ğŸ• *Bem-vindo ao [Nome do Restaurante]!*\n\nSeu delivery favorito chegou no WhatsApp!\n\nğŸ›µ *Delivery grÃ¡tis acima de R$ 30*\nâ° *Tempo mÃ©dio: 35-45 minutos*\nğŸ’³ *Pagamento: Dinheiro, PIX, CartÃ£o*\n\nğŸ½ï¸ *O que vai ser hoje?*\n\nğŸ• Pizzas tradicionais\nğŸ Massas artesanais\nğŸ” HambÃºrguers gourmet\nğŸ¥— Saladas fresquinhas\nğŸ° Sobremesas especiais\nğŸ¥¤ Bebidas geladas\n\n*Digite o nÃºmero da categoria ou me fale o que estÃ¡ procurando!*",
        "isMainMenu": true
      }
    },
    {
      "id": "get_customer_location",
      "type": "message",
      "position": { "x": 500, "y": 100 },
      "data": {
        "label": "LocalizaÃ§Ã£o Cliente",
        "message": "ğŸ“ *Qual Ã© o seu endereÃ§o para entrega?*\n\nPreciso saber onde vocÃª estÃ¡ para:\nâ€¢ Calcular a taxa de entrega\nâ€¢ Estimar tempo de chegada\nâ€¢ Confirmar nossa Ã¡rea de atendimento\n\nğŸ“± *VocÃª pode:*\nâ€¢ Enviar sua localizaÃ§Ã£o pelo WhatsApp\nâ€¢ Digitar o endereÃ§o completo\nâ€¢ Informar apenas o bairro (para comeÃ§ar)\n\nğŸ’¡ *Dica: Quanto mais preciso o endereÃ§o, mais rÃ¡pida a entrega!*"
      }
    },
    {
      "id": "validate_delivery_area",
      "type": "webhook",
      "position": { "x": 700, "y": 100 },
      "data": {
        "label": "Validar Ãrea",
        "url": "{{DELIVERY_SYSTEM_URL}}/validate-area",
        "method": "POST",
        "payload": {
          "address": "{{customer_address}}",
          "coordinates": "{{customer_coordinates}}"
        }
      }
    },
    {
      "id": "check_delivery_area",
      "type": "condition",
      "position": { "x": 900, "y": 100 },
      "data": {
        "label": "Verificar Ãrea",
        "condition": "webhook_response.delivers_to === true",
        "description": "Verifica se entregamos na regiÃ£o"
      }
    },
    {
      "id": "area_not_covered",
      "type": "message",
      "position": { "x": 900, "y": 200 },
      "data": {
        "label": "Ãrea NÃ£o Atendida",
        "message": "ğŸ˜” *Ops! Ainda nÃ£o entregamos na sua regiÃ£o.*\n\nğŸ“ *Atendemos atualmente:*\nâ€¢ Centro e regiÃ£o central\nâ€¢ Bairros: [Lista dos bairros]\nâ€¢ Raio de atÃ© 8km do restaurante\n\nğŸª *Alternativas para vocÃª:*\nâ€¢ Retirada no balcÃ£o (desconto de 10%)\nâ€¢ Delivery via iFood/Uber Eats\nâ€¢ Agende para quando estivermos na sua Ã¡rea\n\nğŸ“§ *Deixe seu contato e te avisamos quando chegarmos na sua regiÃ£o!*\n\n*Deseja fazer retirada no balcÃ£o?*"
      }
    },
    {
      "id": "show_menu_categories",
      "type": "message",
      "position": { "x": 1100, "y": 100 },
      "data": {
        "label": "Categorias CardÃ¡pio",
        "message": "ğŸ½ï¸ *Nosso CardÃ¡pio Completo*\n\nâœ… *Ãrea de entrega: {{customer_area}}*\nğŸšš *Taxa de entrega: {{delivery_fee}}*\nâ° *Tempo estimado: {{estimated_time}}*\n\n*Escolha uma categoria:*\n\nğŸ• *1. PIZZAS* (15 sabores)\n   â€¢ Tradicionais, Especiais, Doces\n   â€¢ A partir de R$ 25,90\n\nğŸ *2. MASSAS* (8 opÃ§Ãµes)\n   â€¢ Espaguete, Penne, Lasanhas\n   â€¢ A partir de R$ 18,90\n\nğŸ” *3. HAMBÃšRGUERS* (12 opÃ§Ãµes)\n   â€¢ Artesanais, Veganos, Kids\n   â€¢ A partir de R$ 22,90\n\nğŸ¥— *4. SALADAS* (6 opÃ§Ãµes)\n   â€¢ Verdes, Proteicas, Especiais\n   â€¢ A partir de R$ 16,90\n\nğŸ° *5. SOBREMESAS* (8 opÃ§Ãµes)\n   â€¢ Doces caseiros, Sorvetes\n   â€¢ A partir de R$ 8,90\n\nğŸ¥¤ *6. BEBIDAS* (20+ opÃ§Ãµes)\n   â€¢ Refrigerantes, Sucos, Cervejas\n   â€¢ A partir de R$ 4,90\n\n*Digite o nÃºmero da categoria!*"
      }
    },
    {
      "id": "show_category_items",
      "type": "webhook",
      "position": { "x": 1300, "y": 100 },
      "data": {
        "label": "Itens da Categoria",
        "url": "{{MENU_SYSTEM_URL}}/category/{{selected_category}}",
        "method": "GET"
      }
    },
    {
      "id": "display_menu_items",
      "type": "llm",
      "position": { "x": 1500, "y": 100 },
      "data": {
        "label": "Exibir Itens",
        "prompt": "Crie uma apresentaÃ§Ã£o atrativa dos itens do cardÃ¡pio:\n\nCategoria: {{selected_category}}\nItens disponÃ­veis: {{menu_items}}\n\nFormato da resposta:\n\"ğŸ½ï¸ *[CATEGORIA] - Escolha seu favorito:*\n\n[Para cada item]\nğŸ”¢ *[NÃºmero]. [Nome do Prato]*\n   ğŸ’° R$ [PreÃ§o]\n   ğŸ“ [DescriÃ§Ã£o breve]\n   â­ [Nota/RecomendaÃ§Ã£o se houver]\n\nğŸ’¡ *Dica: Digite o nÃºmero do prato para adicionar ao pedido!*\n\nğŸ”™ Digite 'menu' para voltar Ã s categorias\"\n\nSeja descritivo e apetitoso nas descriÃ§Ãµes!",
        "timeout": 15000,
        "useBalancer": true
      }
    },
    {
      "id": "add_to_cart",
      "type": "message",
      "position": { "x": 1700, "y": 100 },
      "data": {
        "label": "Adicionar ao Carrinho",
        "message": "ğŸ›’ *Adicionado ao seu carrinho!*\n\n*Quer personalizar seu pedido?*\n\nğŸ• *Se for pizza:*\n   â€¢ Borda recheada? (+ R$ 5,00)\n   â€¢ Extra queijo? (+ R$ 3,00)\n   â€¢ Retirar ingrediente?\n\nğŸ” *Se for hambÃºrguer:*\n   â€¢ Ponto da carne?\n   â€¢ Adicionais? (bacon, queijo, etc.)\n   â€¢ Batata frita? (+ R$ 8,00)\n\nğŸ¥¤ *Bebida para acompanhar?*\n   â€¢ Refrigerante 350ml (+ R$ 4,90)\n   â€¢ Suco natural (+ R$ 6,90)\n\n*PersonalizaÃ§Ãµes:*\nDigite suas preferÃªncias ou 'continuar' para prosseguir."
      }
    },
    {
      "id": "show_cart_summary",
      "type": "webhook",
      "position": { "x": 1900, "y": 100 },
      "data": {
        "label": "Resumo Carrinho",
        "url": "{{ORDER_SYSTEM_URL}}/cart/{{session_id}}",
        "method": "GET"
      }
    },
    {
      "id": "display_cart",
      "type": "llm",
      "position": { "x": 1500, "y": 300 },
      "data": {
        "label": "Exibir Carrinho",
        "prompt": "Crie um resumo atrativo do carrinho de compras:\n\nItens no carrinho: {{cart_items}}\nSubtotal: {{subtotal}}\nTaxa de entrega: {{delivery_fee}}\nTotal: {{total}}\n\nFormato:\n\"ğŸ›’ *SEU CARRINHO*\n\n[Para cada item]\nğŸ½ï¸ [Quantidade]x [Nome do Prato]\n   ğŸ’° R$ [PreÃ§o unitÃ¡rio] = R$ [Subtotal]\n   ğŸ“ [PersonalizaÃ§Ãµes se houver]\n\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\nğŸ’µ *Subtotal:* R$ [valor]\nğŸšš *Entrega:* R$ [valor]\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\nğŸ’¸ *TOTAL:* R$ [valor]\n\n*OpÃ§Ãµes:*\nâœ… Finalizar pedido\nâ• Adicionar mais itens\nâœï¸ Editar quantidades\nğŸ—‘ï¸ Remover item\n\nDigite sua escolha!\"",
        "timeout": 15000,
        "useBalancer": true
      }
    },
    {
      "id": "checkout_process",
      "type": "message",
      "position": { "x": 1300, "y": 400 },
      "data": {
        "label": "Processo Checkout",
        "message": "ğŸ’³ *FinalizaÃ§Ã£o do Pedido*\n\n*Confirme seus dados:*\n\nğŸ“ *EndereÃ§o de entrega:*\n{{delivery_address}}\n\nğŸ“± *Telefone:* {{customer_phone}}\nğŸ‘¤ *Nome:* {{customer_name}}\n\nğŸ’° *Total do pedido:* R$ {{total_amount}}\n\nğŸ’³ *Forma de pagamento:*\n1ï¸âƒ£ ğŸ’¸ Dinheiro (precisa de troco?)\n2ï¸âƒ£ ğŸ’³ CartÃ£o na entrega\n3ï¸âƒ£ ğŸ“± PIX (desconto de 5%)\n4ï¸âƒ£ ğŸ’° CartÃ£o online\n\nâ° *Tempo de entrega:* {{estimated_delivery}}\n\n*Escolha a forma de pagamento:*"
      }
    },
    {
      "id": "process_payment",
      "type": "llm",
      "position": { "x": 1100, "y": 400 },
      "data": {
        "label": "Processar Pagamento",
        "prompt": "Processe a escolha de pagamento do cliente:\n\nEscolha: {{payment_choice}}\nTotal: {{total_amount}}\n\nSe PIX:\n- Aplicar desconto de 5%\n- Gerar instruÃ§Ãµes para PIX\n- Informar dados bancÃ¡rios\n\nSe dinheiro:\n- Perguntar se precisa de troco\n- Quanto de troco?\n\nSe cartÃ£o:\n- Confirmar modalidade (dÃ©bito/crÃ©dito)\n- Informar que mÃ¡quina estÃ¡ disponÃ­vel\n\nRetornar instruÃ§Ãµes especÃ­ficas para o pagamento escolhido.",
        "timeout": 15000,
        "useBalancer": true
      }
    },
    {
      "id": "confirm_order",
      "type": "webhook",
      "position": { "x": 900, "y": 400 },
      "data": {
        "label": "Confirmar Pedido",
        "url": "{{ORDER_SYSTEM_URL}}/confirm",
        "method": "POST",
        "payload": {
          "customer_data": "{{customer_info}}",
          "cart_items": "{{cart_contents}}",
          "payment_method": "{{payment_type}}",
          "delivery_address": "{{delivery_location}}",
          "total_amount": "{{final_total}}",
          "estimated_time": "{{delivery_estimate}}"
        }
      }
    },
    {
      "id": "order_confirmed",
      "type": "message",
      "position": { "x": 700, "y": 400 },
      "data": {
        "label": "Pedido Confirmado",
        "message": "ğŸ‰ *PEDIDO CONFIRMADO!*\n\nğŸ“‹ *NÃºmero do pedido:* #{{order_number}}\nâ° *PrevisÃ£o de entrega:* {{delivery_time}}\nğŸ’° *Total:* R$ {{final_amount}}\nğŸ’³ *Pagamento:* {{payment_method}}\n\nğŸ‘¨â€ğŸ³ *Status atual:* Preparando seu pedido\n\nğŸ›µ *Acompanhamento:*\nVou te mandar atualizaÃ§Ãµes em tempo real:\nâ€¢ âœ… Pedido confirmado\nâ€¢ ğŸ‘¨â€ğŸ³ Em preparo\nâ€¢ ğŸ“¦ Saiu para entrega\nâ€¢ ğŸ  Chegou ao destino\n\nğŸ“± *Contato do entregador:* SerÃ¡ enviado quando sair\n\nğŸ”” *DÃºvidas?*\nDigite 'status' para acompanhar\nDigite 'contato' para falar conosco\n\n*Obrigado pela preferÃªncia! ğŸ˜‹*"
      }
    },
    {
      "id": "track_order",
      "type": "webhook",
      "position": { "x": 500, "y": 500 },
      "data": {
        "label": "Rastrear Pedido",
        "url": "{{ORDER_SYSTEM_URL}}/track/{{order_number}}",
        "method": "GET"
      }
    },
    {
      "id": "show_order_status",
      "type": "llm",
      "position": { "x": 700, "y": 500 },
      "data": {
        "label": "Status do Pedido",
        "prompt": "Crie uma mensagem de acompanhamento do pedido:\n\nDados do pedido: {{order_data}}\nStatus atual: {{current_status}}\nTempo estimado: {{remaining_time}}\n\nFormatos possÃ­veis:\n\nSe em preparo:\n\"ğŸ‘¨â€ğŸ³ *Seu pedido estÃ¡ sendo preparado!*\nâ° Tempo restante: [X] minutos\nğŸ“ Status: [detalhes]\nğŸ”¥ Nosso chef estÃ¡ caprichando!\"\n\nSe saiu para entrega:\n\"ğŸ›µ *Pedido a caminho!*\nğŸ“± Entregador: [nome] - [telefone]\nğŸ“ DistÃ¢ncia: [X]km\nâ° Chega em: [X] minutos\nğŸ”´ Acompanhe em tempo real\"\n\nSempre manter tom animado e informativo.",
        "timeout": 15000,
        "useBalancer": true
      }
    },
    {
      "id": "delivery_feedback",
      "type": "message",
      "position": { "x": 900, "y": 500 },
      "data": {
        "label": "Feedback Entrega",
        "message": "ğŸ½ï¸ *Entrega realizada com sucesso!*\n\nEsperamos que tenha aproveitado sua refeiÃ§Ã£o!\n\nâ­ *Como foi nossa entrega hoje?*\n\nğŸ˜ Excelente - Superou expectativas\nğŸ˜Š Muito bom - Recomendo\nğŸ˜ Bom - Dentro do esperado\nğŸ˜• Regular - Pode melhorar\nğŸ˜ Ruim - Tive problemas\n\nğŸ“ *Conte mais:*\nâ€¢ Como estava a comida?\nâ€¢ O entregador foi atencioso?\nâ€¢ A entrega chegou no tempo?\nâ€¢ Alguma sugestÃ£o?\n\nğŸ *AvaliaÃ§Ãµes nos ajudam a melhorar e vocÃª ganha pontos para desconto na prÃ³xima!*\n\n*Use os emojis ou descreva sua experiÃªncia:*"
      }
    },
    {
      "id": "save_feedback",
      "type": "webhook",
      "position": { "x": 1100, "y": 500 },
      "data": {
        "label": "Salvar AvaliaÃ§Ã£o",
        "url": "{{FEEDBACK_SYSTEM_URL}}/rating",
        "method": "POST",
        "payload": {
          "order_id": "{{order_number}}",
          "customer_rating": "{{customer_feedback}}",
          "delivery_rating": "{{delivery_experience}}",
          "comments": "{{additional_comments}}",
          "timestamp": "{{current_timestamp}}"
        }
      }
    },
    {
      "id": "thank_you_message",
      "type": "message",
      "position": { "x": 1300, "y": 500 },
      "data": {
        "label": "Agradecimento",
        "message": "ğŸ™ *Muito obrigado pelo seu feedback!*\n\nSua opiniÃ£o Ã© fundamental para continuarmos melhorando.\n\nğŸ *VocÃª ganhou:*\nâ€¢ 50 pontos de fidelidade\nâ€¢ 10% de desconto na prÃ³xima\nâ€¢ Prioridade no atendimento\n\nğŸ“± *Nos salve nos contatos:*\nâ€¢ WhatsApp: (11) 9999-9999\nâ€¢ Instagram: @[restaurante]\nâ€¢ Site: www.[restaurante].com.br\n\nğŸ½ï¸ *Novidades sempre chegando:*\nâ€¢ Novos pratos toda semana\nâ€¢ PromoÃ§Ãµes exclusivas no WhatsApp\nâ€¢ CardÃ¡pio sazonal\n\nğŸ”„ *Para um novo pedido:*\nDigite 'menu' ou 'novo pedido'\n\n*AtÃ© a prÃ³xima refeiÃ§Ã£o deliciosa! ğŸ˜‹ğŸ•*"
      }
    }
  ],
  "edges": [
    { "id": "e1", "source": "start-1", "target": "restaurant_welcome" },
    { "id": "e2", "source": "restaurant_welcome", "target": "get_customer_location" },
    { "id": "e3", "source": "get_customer_location", "target": "validate_delivery_area" },
    { "id": "e4", "source": "validate_delivery_area", "target": "check_delivery_area" },
    { "id": "e5", "source": "check_delivery_area", "target": "area_not_covered", "label": "false" },
    { "id": "e6", "source": "check_delivery_area", "target": "show_menu_categories", "label": "true" },
    { "id": "e7", "source": "show_menu_categories", "target": "show_category_items" },
    { "id": "e8", "source": "show_category_items", "target": "display_menu_items" },
    { "id": "e9", "source": "display_menu_items", "target": "add_to_cart" },
    { "id": "e10", "source": "add_to_cart", "target": "show_cart_summary" },
    { "id": "e11", "source": "show_cart_summary", "target": "display_cart" },
    { "id": "e12", "source": "display_cart", "target": "checkout_process" },
    { "id": "e13", "source": "checkout_process", "target": "process_payment" },
    { "id": "e14", "source": "process_payment", "target": "confirm_order" },
    { "id": "e15", "source": "confirm_order", "target": "order_confirmed" },
    { "id": "e16", "source": "order_confirmed", "target": "track_order" },
    { "id": "e17", "source": "track_order", "target": "show_order_status" },
    { "id": "e18", "source": "show_order_status", "target": "delivery_feedback" },
    { "id": "e19", "source": "delivery_feedback", "target": "save_feedback" },
    { "id": "e20", "source": "save_feedback", "target": "thank_you_message" }
  ],
  "configuration": {
    "webhooks": {
      "delivery_system": {
        "base_url": "https://api.delivery.com",
        "auth_header": "Authorization: Bearer {{DELIVERY_API_KEY}}",
        "timeout": 8000
      },
      "menu_system": {
        "base_url": "https://api.menu.com",
        "auth_header": "X-API-Key: {{MENU_API_KEY}}",
        "timeout": 5000
      },
      "order_system": {
        "base_url": "https://api.orders.com",
        "auth_header": "Authorization: Bearer {{ORDER_API_KEY}}",
        "timeout": 10000
      }
    },
    "variables": {
      "DELIVERY_SYSTEM_URL": "https://api.delivery.com/v1",
      "MENU_SYSTEM_URL": "https://api.menu.com/v1",
      "ORDER_SYSTEM_URL": "https://api.orders.com/v1",
      "FEEDBACK_SYSTEM_URL": "https://api.feedback.com/v1",
      "restaurant_name": "Seu Restaurante",
      "min_order_free_delivery": "30.00",
      "max_delivery_distance": "8",
      "avg_preparation_time": "35"
    },
    "settings": {
      "free_delivery_threshold": 30.00,
      "max_delivery_radius_km": 8,
      "average_prep_time_minutes": 35,
      "pix_discount_percent": 5,
      "loyalty_points_per_order": 50,
      "enable_order_tracking": true,
      "enable_feedback_system": true,
      "auto_status_updates": true
    }
  }
}